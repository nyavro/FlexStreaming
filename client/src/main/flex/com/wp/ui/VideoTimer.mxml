<?xml version="1.0"?>
<mx:Box xmlns:fx="http://ns.adobe.com/mxml/2009" xmlns:mx="library://ns.adobe.com/flex/mx">
    <fx:Script><![CDATA[
        private var timer:Timer;
        private var timeLeft:int;
        private var callback:Function;

        public function start(duration:int, callback:Function):void {
            this.timeLeft = duration;
            this.callback = callback;

            timerDisplay.visible = true;
            timerDisplay.text = timeLeft + "";
            timer = new Timer(1000);
            timer.addEventListener(TimerEvent.TIMER, displayTimeLeft);
            timer.start();
        }

        public function stop():void {
            timerDisplay.visible = false;
            timer.stop();
        }

        private function displayTimeLeft(event:TimerEvent):void {
            timeLeft--;
            if(timeLeft==0) {
                timerDisplay.visible = false;
                timer.stop();
                callback();
            } else {
                timerDisplay.text = timeLeft + "";
            }
        }

        ]]></fx:Script>
    <mx:Text id="timerDisplay" visible="false" color="#0FF000"/>
</mx:Box>
